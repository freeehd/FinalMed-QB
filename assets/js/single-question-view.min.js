jQuery(document).ready(n=>{const e=n("#wqb-single-question-root"),d=window.wqb_single_question_data.ajax_url,w=window.wqb_single_question_data.nonce,o=window.wqb_single_question_data.question,r=window.wqb_single_question_data.session_id;let u={};e.on("click","#wqb-submit-answer",q),e.on("click","#wqb-return-to-lobby",()=>window.location.href="/staging-area");function b(){if(!o||!r){e.html('<div class="wqb-error">Could not load question data.</div>');return}u={current_index:0,total:1,mode:"practice"},p({question:o,current:1,total:1})}function q(){const t=n('input[name="wqb_answer"]:checked');if(t.length===0){alert("Please select an answer.");return}const s=t.val(),i=o.id;n.ajax({url:d,type:"POST",data:{action:"wqb_submit_answer",nonce:w,question_id:i,answer_index:s,session_id:r},dataType:"json",success:a=>{a.success?v(a.data,s):alert(a.data.message)}})}function p({question:t,current:s,total:i}){let a=`
      <div class="wqb-practice-view" data-question-id="${t.id}" style="padding: 20px; border: 1px solid #ddd; border-radius: 8px;">
          <div class="wqb-practice-header">
              <div class="wqb-question-counter">Testing Question ${t.id}</div>
          </div>
          <div class="wqb-question-prompt">${t.prompt}</div>
          <div class="wqb-answer-options">`;t.options.forEach((_,l)=>{a+=`<label class="wqb-option">
                          <input type="radio" name="wqb_answer" value="${l}">
                          <span class="wqb-option-letter">${String.fromCharCode(65+l)}</span>
                          <span class="wqb-option-text">${_}</span>
                       </label>`}),a+=`</div>
           <div class="wqb-practice-footer">
              ${c(!1)}
           </div>
        </div>`,e.html(a)}function c(t){return t?'<div class="wqb-navigation-buttons"><button id="wqb-return-to-lobby" class="wqb-button-secondary">Return</button></div>':'<div class="wqb-navigation-buttons"><button id="wqb-submit-answer" class="wqb-button-primary">Submit Answer</button></div>'}function v(t,s){n(".wqb-option input").prop("disabled",!0),n(`.wqb-option input[value="${t.correct_index}"]`).parent().addClass("correct-answer"),t.is_correct||n(`.wqb-option input[value="${s}"]`).parent().addClass("incorrect-answer");const i=`
      <div class="wqb-question-analytics">
          <h4>Answer Analysis</h4>
          <div class="wqb-analytics-item wqb-analytics-full">
              <span class="wqb-analytics-label">Explanation:</span>
              <div class="wqb-analytics-explanation">${t.explanation}</div>
          </div>
      </div>`;n(".wqb-practice-view").append(i),n(".wqb-practice-footer").html(c(!0))}b()});
